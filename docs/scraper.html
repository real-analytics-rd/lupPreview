---

title: The Guardian Scraper


keywords: fastai
sidebar: home_sidebar

summary: "Scraping Premier League Previews from the Guardian."
description: "Scraping Premier League Previews from the Guardian."
nb_path: "00_scraper.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_scraper.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div style="font-size: 200px">

<table>
<thead><tr>
<th>Issues</th>
<th>Solutions</th>
</tr>
</thead>
<tbody>
<tr>
<td>4 possible formats for previews(old format, new format,Cup's format and a particular format)</td>
<td>Select the appropriate html tags</td>
</tr>
<tr>
<td>Preview titles are not the same ( we can find Squad Sheets or match preview)</td>
<td>Pick only the names of the teams and eliminate the rest</td>
</tr>
<tr>
<td>The date of the match is not always available</td>
<td>Pick the preview date</td>
</tr>
<tr>
<td>The order of the elements and labels are not the same</td>
<td>Using regex patterns to get information</td>
</tr>
<tr>
<td>Missing values for betting odds</td>
<td>We treat the general case separately and we set up specific regex patterns for these particular cases</td>
</tr>
<tr>
<td>Odds format is different</td>
<td>We treat the general case separately and we set up specific regex patterns for these particular cases</td>
</tr>
<tr>
<td>We can find non-numeric values for Odds like (Evens,evens,Eve)</td>
<td>Replace evens by 1-1</td>
</tr>
<tr>
<td>There are some previews that don't have author and text</td>
<td>For previews that have no text, we put 'n/a' (not available)</td>
</tr>
<tr>
<td>The existence of previews for the FA CUP,Carabao Cup,Champions league,World Cup</td>
<td>Filter previews by title,link,topic,aside html section and preview text and allow only Premier League previews</td>
</tr>
<tr>
<td>We are not sure if the names of the teams are the same as the ones in Opta</td>
<td>Set up a dictionary or check manually to map teams to their IDs</td>
</tr>
<tr>
<td>When we send many requests, the guardian server blocks your IP address, which is interpreted as a DDOS attack</td>
<td>Do a sleep of a random x seconds between requests or change your IP and work with rotating proxy</td>
</tr>
</tbody>
</table>
<p>&lt;/div &gt;</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Import-Libraries-and-Modules">Import Libraries and Modules<a class="anchor-link" href="#Import-Libraries-and-Modules"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Parser-Class">Parser Class<a class="anchor-link" href="#Parser-Class"> </a></h3><h5 id="This-class-is-used-to-parse-pages-and-has-3-functions:">This class is used to parse pages and has 3 functions:<a class="anchor-link" href="#This-class-is-used-to-parse-pages-and-has-3-functions:"> </a></h5><p>1- <b> parse_page </b> function:retrieves the html format of a given web page link.</p>
<p>2- <b> store_page_locally </b> function: save a preview page in a specified local folder.</p>
<p>3- <b> get_next_page </b> function: retrieves the link to the next page and determines if it is the last page of previews in order to stop scraping.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Parser" class="doc_header"><code>class</code> <code>Parser</code><a href="https://github.com/MeherKharbachi/guardian_scraper/tree/master/guardian_scraper/scraper.py#L23" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Parser</code>()</p>
</blockquote>
<p>A class to represent previews pages parser.</p>
<p>...</p>
<h2 id="Methods">Methods<a class="anchor-link" href="#Methods"> </a></h2><p>parse_page(page_url, session)
    returns the html format of the page.
store_page_locally(page, page_url)
    save a given page in a local folder.
get_next_page(page)
    returns the link of the following page and if it's the last page.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="PageExtractor-Class">PageExtractor Class<a class="anchor-link" href="#PageExtractor-Class"> </a></h3><h5 id="This-class-has-five-functions-for-extracting-data-from-a-given-football-preview:">This class has five functions for extracting data from a given football preview:<a class="anchor-link" href="#This-class-has-five-functions-for-extracting-data-from-a-given-football-preview:"> </a></h5><p>1- <b> get_values_matching_regex </b> returns values that match a regex expression.</p>
<p>&emsp;Because the "Guardian" website has two possible formats, we defined two possible classifiers for the p tags <br>&emsp;containing the information to be extracted.<br>
&emsp;We go through each p section, and if we find the result, we return it; otherwise, a None is returned.<br>
&emsp;The result is a list of tuples, with each tuple representing a value that matches the regex pattern.<br> &emsp;Unsatisfied patterns for regexes that include <b>OR</b> conditions will be empty tuples. That's why you need to get rid of it.</p>
<p>2- <b> extract_teams_names </b> returns the names of the two teams in a football preview.</p>
<p>&emsp;The preview includes team names at the title level.
 <br>&emsp;example:
          &emsp;&emsp;{{Squad Sheets: Team A v Team B}} 
         or &emsp;&emsp;{{Team A v Team B: match preview}} 
         or &emsp;&emsp;{{Team A v Team B: Squad Sheets}}
<br>&emsp;As a result, our strategy is to delete the text preceding or following the names and recover each name <br>&emsp;individually.
<br>&emsp;If we were successful in obtaining the names, they will be returned in a Python dictionary; <br>&emsp;otherwise, the values will be 'n/a'(Not available).</p>
<p>3- <b> extract_text_authors </b>returns the text and author of a football preview.</p>
<p>&emsp;It's difficult to determine the position of the text, but it's almost certainly the block with the most <br>&emsp;characters.
<br>&emsp;To proceed, we store each paragraph and its size in a Python dictionary, and then we take the <br>&emsp;block with the largest size.
<br>&emsp;To be sure, we double-check by only accepting texts with a size greater than 160 because there <br>&emsp;are football previews with no text or author.
<br>&emsp;Furthermore, the author information is always under the text section, more specifically in a <br>&emsp;strong tag, so if the text does not exist, the author is missing as well.
If we were successful in <br>&emsp;obtaining the text and the author, they will be returned in a Python dictionary. Otherwise, the <br>&emsp;values will be 'n/a'(Not available).</p>
<p>4- <b> extract_preview_date </b> returns the date of publication of a football preview.</p>
<p>&emsp;We have distinguished two dates for the date of publication: the first is the date of publication, <br>&emsp;and the second is the date of the most recent modification.
In this sense, we go through the <br>&emsp;section where the two dates are located and take only the first and use 'dateparser' to convert <br>&emsp;the string into a date in "yyyy-mm-dd" format.
If we were successful in obtaining the date, it will <br>&emsp; be returned. Otherwise, the value will be 'n/a'(Not available).</p>
<p>5- <b> extract_match_infos </b> returns a football match information (venue, referee, odds).</p>
<p>&emsp;Here, we'll call the first function <b>get_values_matching_regex</b> , which will allow us to retrieve this<br>&emsp;information by specifying a regex expression for each.<br>&emsp;If this data is not available, the value will be 'n/a'.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PageExtractor" class="doc_header"><code>class</code> <code>PageExtractor</code><a href="https://github.com/MeherKharbachi/guardian_scraper/tree/master/guardian_scraper/scraper.py#L133" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PageExtractor</code>()</p>
</blockquote>
<p>A class to represent an information extractor from a football preview.</p>
<p>...</p>
<h2 id="Methods">Methods<a class="anchor-link" href="#Methods"> </a></h2><p>get_values_matching_regex(page, regex)
    return all matched patterns from a preview page.
extract_teams_names(title)
    returns team names from the preview title.
extract_text_authors(page)
    returns the text and author of the preview.
extract_preview_date(page)
    returns the publication date of the preview.
extract_match_infos(page, venue_regex, referee_regex, odds_regex)
    returns a football match information (venue,referee,odds).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ScrapingTheGuardian-Class">ScrapingTheGuardian Class<a class="anchor-link" href="#ScrapingTheGuardian-Class"> </a></h3><h5 id="This-class-represents-a-scraper-from-the-&quot;Guardian&quot;-website-and-has-4-functions:">This class represents a scraper from the "Guardian" website and has 4 functions:<a class="anchor-link" href="#This-class-represents-a-scraper-from-the-&quot;Guardian&quot;-website-and-has-4-functions:"> </a></h5><p>1- <b> calculate_betting_odds </b> returns decimal odds.</p>
<p>&emsp;In this section, we will calculate the odds derived from the football preview.
<br>&emsp;Considering the following example:
<br>&emsp;&emsp; ["9-20","29-5","6-5"] 
<br>&emsp;&emsp;We calculate each sport's rating separately using the following formula:
<br>&emsp;&emsp;&emsp; home = (9/20) + 1 
<br>&emsp;&emsp;&emsp; away = (29/5) + 1
<br>&emsp;&emsp;&emsp; draw = (6/5) + 1
<br>&emsp;If we were successful in obtaining decimal odds, they will be returned in a Python dictionary.<br>&emsp;Otherwise, the values will be 'n/a'(Not available).</p>
<p>2- <b> extract_preview_items </b>returns the entire contents of a football preview.</p>
<p>&emsp;In this section, we will call the functions defined in the PageExtractor class and return a Python dictionary containing all of this information.
<br>&emsp;But first, we use the <b>calculate_betting_odds</b> function to calculate the sports odds for the home team's victory, the away team's victory, and a draw.</p>
<p>"home team","away team","text","author","venue","referee","odds","odds home team","odds away team","odds draw", "preview date","preview_link" are the returned values.</p>
<p>3- <b> save_previews_locally </b> save all browsed previews in a local folder.</p>
<p>&emsp;For a given page, we retrieve all the previews and go through them one by one, taking the link, title, subject, and aside section.
<br>&emsp;if the words "cup" or "champions league" do not belong in these sections, we save the preview in a local folder
<br>&emsp;Otherwise, we move on to the next preview.
<br>&emsp;The <b>store_page_locally</b> function, will be called here to save the preview page.</p>
<p>4- <b> extract_previews_information </b> returns the information of all local previews.</p>
<p>&emsp;In a local folder, we extract the information for each file (preview in html format) by calling the <b> extract_preview_items</b> function <br>&emsp;and then we save the information for each preview in a list.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ScrapingTheGuardian" class="doc_header"><code>class</code> <code>ScrapingTheGuardian</code><a href="https://github.com/MeherKharbachi/guardian_scraper/tree/master/guardian_scraper/scraper.py#L383" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ScrapingTheGuardian</code>()</p>
</blockquote>
<p>A class to represent a scraper from the "Guardian" website.</p>
<p>...</p>
<h2 id="Attributes">Attributes<a class="anchor-link" href="#Attributes"> </a></h2><p>session : requests_html.HTMLSession
    a web session
VENUE_REGEX : str
    venue regex expression
REFEREE_REGEX : str
    referee regex expression
ODDS_REGEX : str
    odds regex expression</p>
<h2 id="Methods">Methods<a class="anchor-link" href="#Methods"> </a></h2><p>calculate_betting_odds(odds)
    returns decimal odds.
extract_preview_items(page,title)
    returns all information of a football preview.
save_previews_locally(self,page)
    save all browsed previews in a local folder.
extract_previews_information(self,folder_path)
    returns all the information of all local previews.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="PreviewsMapping-Class">PreviewsMapping Class<a class="anchor-link" href="#PreviewsMapping-Class"> </a></h3><h5 id="This-class-represents-a-mapper-from-the-&quot;Opta&quot;-MongoDb-database-and-has-3-functions:">This class represents a mapper from the "Opta" MongoDb database and has 3 functions:<a class="anchor-link" href="#This-class-represents-a-mapper-from-the-&quot;Opta&quot;-MongoDb-database-and-has-3-functions:"> </a></h5><p>1- <b> get_team_id </b> returns the "opta" ID of a given team.</p>
<p>&emsp;The use of a predefined dictionary containing the teams and their various names facilitates us in matching the team names extracted from the guardian and <br>&emsp;their IDs in the opta database. The use of a dictionary was required because the team names in the previews differ and sometimes use abbreviations or<br>&emsp;nicknames.</p>
<p>2- <b> get_game_id </b>returns the id and the date of a given game.</p>
<p>&emsp;After completing the scraping task and extracting the information, the previews must be matched with their ids in the opta.fixture database.
We will query this <br>&emsp;database by specifying the home team, the away team, the closest gamedate to the preview publication date, and the Premier League competitionId, which  <br>&emsp;is equal to 8 in the database.</p>
<p>3- <b> save_mapped_data </b> save all the mapped previews in a MongoDb collection.</p>
<p>&emsp;For each preview in the data extracted from the Guardian, we will look for the id of the home team and the away team and match it with the <b>opta.fixture</b><br>&emsp;database to get the gameID and gameDate and finally we save it in a MongoDb collection.
<br>&emsp;To complete our mission, we will call the last two functions <b> get_team_id </b> and <b>get_game_id</b>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PreviewsMapping" class="doc_header"><code>class</code> <code>PreviewsMapping</code><a href="https://github.com/MeherKharbachi/guardian_scraper/tree/master/guardian_scraper/scraper.py#L688" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PreviewsMapping</code>()</p>
</blockquote>
<p>A class to represent a data mapper from a mongo database.</p>
<p>...</p>
<h2 id="Methods">Methods<a class="anchor-link" href="#Methods"> </a></h2><p>get_team_id(team_name, df_teams)
    returns the "opta" ID of a given team.
get_game_id_date(home_team_id, away_team_id, preview_date)
    returns the id and the date of a given game.
get_mapped_data(data,df_teams)
    save all the mapped previews in a MongoDb collection.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Previews-Class">Previews Class<a class="anchor-link" href="#Previews-Class"> </a></h3><h5 id="This-class-represents-the-extracted-previews-from-the-guardian:">This class represents the extracted previews from the guardian:<a class="anchor-link" href="#This-class-represents-the-extracted-previews-from-the-guardian:"> </a></h5><p>We created a class that contains the various attributes to store in order to save every preview information extracted from the Guardian website.
<br>This class ensures that data is stored in a convenient format and type.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Previews" class="doc_header"><code>class</code> <code>Previews</code><a href="https://github.com/MeherKharbachi/guardian_scraper/tree/master/guardian_scraper/scraper.py#L862" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Previews</code>(<strong>*<code>args</code></strong>, <strong>**<code>values</code></strong>) :: <code>Document</code></p>
</blockquote>

<pre><code>A class to represent the extracted previews from the guardian.

</code></pre>
<p>...</p>
<h2 id="Attributes">Attributes<a class="anchor-link" href="#Attributes"> </a></h2><p>game_id : int
    the opta game id
home_team : str
    home team name
away_team : str
    away_team name
text : str
    preview text
author : str
    preview author
venue : str
    match venue
referee : str
    match referee
odds : str
    betting odds
odds_home_team : float
    decimal betting odds for home team
odds_away_team : float
    decimal betting odds for away team
odds_draw : float
    decimal betting odds for draw
game_date : datetime
    the date of the match
preview_date : datetime
    the date of the preview
preview_link : str
    the Guardian preview link</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="MongoCLient-Class">MongoCLient Class<a class="anchor-link" href="#MongoCLient-Class"> </a></h3><h5 id="This-class-represents-a-MongoDb-Client-and-has-2-functions:">This class represents a MongoDb Client and has 2 functions:<a class="anchor-link" href="#This-class-represents-a-MongoDb-Client-and-has-2-functions:"> </a></h5><p>1- <b> find_credentials </b> returns the MongoDb credentials stored in a local file.</p>
<p>2- <b> connect </b>returns the MongoDb instance to connect to a given cluster.</p>
<p>There are two database URIs in the credentials file, the first of which is for the "OPTA" Database.
<br>The second is for another database that was created to store extracted previews.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MongoClient" class="doc_header"><code>class</code> <code>MongoClient</code><a href="https://github.com/MeherKharbachi/guardian_scraper/tree/master/guardian_scraper/scraper.py#L918" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MongoClient</code>()</p>
</blockquote>
<p>A class to represent a MongoDb client.</p>
<p>...</p>
<h2 id="Attributes">Attributes<a class="anchor-link" href="#Attributes"> </a></h2><p>CREDENTIALS_PATH : str
    the file path of the MongoDb credentials</p>
<h2 id="Methods">Methods<a class="anchor-link" href="#Methods"> </a></h2><p>find_credentials()
    returns MongoDb credentials stored in a local file.
connect(index)
    returns the mongoDb instance.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="USE-CASE">USE CASE<a class="anchor-link" href="#USE-CASE"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Scraping-one-page-and-save-its-previews-in-local">Scraping one page and save its previews in local<a class="anchor-link" href="#Scraping-one-page-and-save-its-previews-in-local"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.theguardian.com/football/series/match-previews&quot;</span>
<span class="n">scraper</span> <span class="o">=</span> <span class="n">ScrapingTheGuardian</span><span class="p">()</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">Parser</span><span class="o">.</span><span class="n">parse_page</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">scraper</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>
<span class="n">previews_infos</span> <span class="o">=</span> <span class="n">scraper</span><span class="o">.</span><span class="n">save_previews_locally</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>https://www.theguardian.com/football/2022/jan/22/crystal-palace-liverpool-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/22/leicester-brighton-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/22/arsenal-burnley-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/22/chelsea-tottenham-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/21/manchester-united-west-ham-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/21/southampton-manchester-city-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/21/brentford-wolves-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/21/everton-aston-villa-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/21/leeds-newcastle-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/15/west-ham-leeds-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/15/tottenham-arsenal-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/15/liverpool-brentford-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/14/newcastle-watford-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/14/manchester-city-chelsea-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/14/aston-villa-manchester-united-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/14/norwich-everton-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/14/wolves-southampton-match-preview-premeir-league
https://www.theguardian.com/football/2022/jan/01/brentford-aston-villa-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/01/chelsea-liverpool-match-preview-premier-league
https://www.theguardian.com/football/2022/jan/01/leeds-burnley-match-preview-premier-league
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Scraping-all-pages-and-save-in-local">Scraping all pages and save in local<a class="anchor-link" href="#Scraping-all-pages-and-save-in-local"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>url = "<a href="https://www.theguardian.com/football/series/match-previews">https://www.theguardian.com/football/series/match-previews</a>"
scraper = ScrapingTheGuardian()
last_page = False
while not last_page : 
    print(url)
    page = Parser.parse_page(url,scraper.session)
    previews_infos = scraper.save_previews_locally(page)
    url, last_page = Parser.get_next_page(page)
    time = random.randint(2, 60)
    print("timer")
    print(time)</p>

<pre><code># wait time seconds
sleep(time)</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Extract-information-from-local-previews">Extract information from local previews<a class="anchor-link" href="#Extract-information-from-local-previews"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">local_folder</span> <span class="o">=</span> <span class="s2">&quot;.//previews//&quot;</span>
<span class="n">scraper</span> <span class="o">=</span> <span class="n">ScrapingTheGuardian</span><span class="p">()</span>
<span class="n">all_previews_information</span> <span class="o">=</span> <span class="n">scraper</span><span class="o">.</span><span class="n">extract_previews_information</span><span class="p">(</span><span class="n">local_folder</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;home_team&#39;: &#39;Crystal Palace&#39;, &#39;away_team&#39;: &#39;Liverpool&#39;, &#39;text&#39;: &#39;Liverpool have already dispelled most of the doubts about how they would cope while Mohamed Salah and Sadio Mané are at the Africa Cup of Nations. They are yet to lose without their star forwards but Jürgen Klopp knows there is no room for error if they are to maintain any hope of reeling in Manchester City. Crystal Palace have lost their past nine league meetings with Liverpool by an aggregate score of 27-5 but will be mightily relieved not to be facing Salah and Mané, as they have contributed 17 of those goals between them. Palace are boosted by Jordan Ayew’s early return following Ghana’s Afcon exit. Stephen Hollis&#39;, &#39;author&#39;: &#39;Stephen Hollis&#39;, &#39;venue&#39;: &#39;Selhurst Park&#39;, &#39;referee&#39;: &#39;Kevin Friend&#39;, &#39;odds&#39;: [&#39;5-1&#39;, &#39;8-13&#39;, &#39;10-3&#39;], &#39;odds_home_team&#39;: 6.0, &#39;odds_away_team&#39;: 1.6153846153846154, &#39;odds_draw&#39;: 4.333333333333334, &#39;preview_date&#39;: datetime.date(2022, 1, 22), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/22/crystal-palace-liverpool-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Newcastle&#39;, &#39;away_team&#39;: &#39;Watford&#39;, &#39;text&#39;: &#39;Moussa Sissoko returns to Newcastle in Watford’s midfield as Claudio Ranieri’s side aim to arrest a run of seven straight defeats in all competitions against a Newcastle side with only one win to their name. Both Eddie Howe and Ranieri accept a draw will not be good enough in a relegation skirmish being dubbed a 12-pointer. Much could hinge on the performance of two forwards, Newcastle’s £25m signing, Chris Wood, and Ranieri’s £3.6m leading scorer, Emmanuel Dennis. After this, 17th-placed Watford face two more of the bottom three in the next week, travelling to Burnley on Tuesday and entertaining Norwich on Friday. Louise Taylor&#39;, &#39;author&#39;: &#39;Louise Taylor&#39;, &#39;venue&#39;: &#39;St James’ Park&#39;, &#39;referee&#39;: &#39;Paul Tierney&#39;, &#39;odds&#39;: [&#39;19-17&#39;, &#39;27-10&#39;, &#39;27-10&#39;], &#39;odds_home_team&#39;: 2.1176470588235294, &#39;odds_away_team&#39;: 3.7, &#39;odds_draw&#39;: 3.7, &#39;preview_date&#39;: datetime.date(2022, 1, 14), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/14/newcastle-watford-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Manchester United&#39;, &#39;away_team&#39;: &#39;West Ham&#39;, &#39;text&#39;: &#39;This is a genuine six-pointer in which Manchester United can leapfrog West Ham into fourth if they win, whereas if David Moyes’ side take the spoils they will pull five points ahead of United. After Cristiano Ronaldo drew criticism for his visible unhappiness at being replaced during Wednesday’s win at Brentford there should be no surprise if, neck problem permitting, the 36-year-old sparkles against West Ham. Jamie Jackson&#39;, &#39;author&#39;: &#39;Jamie Jackson&#39;, &#39;venue&#39;: &#39;Old Trafford&#39;, &#39;referee&#39;: &#39;Jon Moss&#39;, &#39;odds&#39;: [&#39;10-11&#39;, &#39;3-1&#39;, &#39;11-4&#39;], &#39;odds_home_team&#39;: 1.9090909090909092, &#39;odds_away_team&#39;: 4.0, &#39;odds_draw&#39;: 3.75, &#39;preview_date&#39;: datetime.date(2022, 1, 21), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/21/manchester-united-west-ham-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Manchester City&#39;, &#39;away_team&#39;: &#39;Chelsea&#39;, &#39;text&#39;: &#39;Manchester City would surely finish off Chelsea’s title challenge if they beat them, as each would have 16 games remaining but the champions a 13-point advantage. Pep Guardiola has further Covid cases to contend with, though the manager has not revealed who they are. Thomas Tuchel is rated highly by Guardiola and, after Chelsea’s 1-0 defeat in the reverse fixture, Tuchel’s plan to turn the champions over on their own turf should fascinate. Jamie Jackson&#39;, &#39;author&#39;: &#39;Jamie Jackson&#39;, &#39;venue&#39;: &#39;Etihad Stadium&#39;, &#39;referee&#39;: &#39;Craig Pawson&#39;, &#39;odds&#39;: [&#39;8-11&#39;, &#39;22-5&#39;, &#39;3-1&#39;], &#39;odds_home_team&#39;: 1.7272727272727273, &#39;odds_away_team&#39;: 5.4, &#39;odds_draw&#39;: 4.0, &#39;preview_date&#39;: datetime.date(2022, 1, 14), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/14/manchester-city-chelsea-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Arsenal&#39;, &#39;away_team&#39;: &#39;Burnley&#39;, &#39;text&#39;: &#39;Arsenal have no excuses if their dismal form in cups continues in the league against Burnley. Mikel Arteta’s side may have struggled recently but they face a team bottom with only one win, recovering from numerous Covid cases and missing their best player, Maxwel Cornet. The Ivorian is into the last 16 of the Africa Cup of Nations with his country and his absence leaves Sean Dyche’s goal-shy side alarmingly short in attack. Arsenal may have shortcomings of their own thanks to the folly of Granit Xhaka and Thomas Partey receiving red cards in successive Carabao Cup matches against Liverpool but if they fail to return to winning ways on Sunday then the dream of returning to the Champions League could start to fade. Graham Searles&#39;, &#39;author&#39;: &#39;Graham Searles&#39;, &#39;venue&#39;: &#39;Emirates Stadium&#39;, &#39;referee&#39;: &#39;David Coote&#39;, &#39;odds&#39;: [&#39;2-5&#39;, &#39;9-1&#39;, &#39;4-1&#39;], &#39;odds_home_team&#39;: 1.4, &#39;odds_away_team&#39;: 10.0, &#39;odds_draw&#39;: 5.0, &#39;preview_date&#39;: datetime.date(2022, 1, 22), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/22/arsenal-burnley-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Brentford&#39;, &#39;away_team&#39;: &#39;Wolves&#39;, &#39;text&#39;: &#39;Wolves have arguably been the surprise package in the Premier League this seasonand a fourth victory in five league games for Bruno Lage’s side at Brentford would raise hopes of challenging for a European place. Wolves’ form has been built on a solid defence – conceding three in their past nine league games – and they will fancy their chances of another clean sheet against a Brentford side that have been struggling in attack with four goals in their past seven matches. Stephen Hollis&#39;, &#39;author&#39;: &#39;Stephen Hollis&#39;, &#39;venue&#39;: &#39;Brentford Community Stadium&#39;, &#39;referee&#39;: &#39;Peter Bankes&#39;, &#39;odds&#39;: [&#39;9-4&#39;, &#39;13-8&#39;, &#39;2-1&#39;], &#39;odds_home_team&#39;: 3.25, &#39;odds_away_team&#39;: 2.625, &#39;odds_draw&#39;: 3.0, &#39;preview_date&#39;: datetime.date(2022, 1, 21), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/21/brentford-wolves-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Everton&#39;, &#39;away_team&#39;: &#39;Aston Villa&#39;, &#39;text&#39;: &#39;The second caretaker coming of Duncan Ferguson has turned what would have been a toxic occasion under Rafael Benítez, and a gift for Aston Villa, into one of eager anticipation among Evertonians but a formidable task awaits the Scot all the same. He leads a team devoid of confidence after one win in 13 matches against improving opponents managed by someone well versed in spoiling the mood at Goodison Park, Steven Gerrard, and who has Lucas Digne and Philippe Coutinho at his disposal for good measure. As Chelsea discovered in Ferguson’s only previous home game, however, a raucous Goodison can inspire. Andy Hunter&#39;, &#39;author&#39;: &#39;Andy Hunter&#39;, &#39;venue&#39;: &#39;Goodison Park&#39;, &#39;referee&#39;: &#39;Craig Pawson&#39;, &#39;odds&#39;: [&#39;7-4&#39;, &#39;17-10&#39;, &#39;40-17&#39;], &#39;odds_home_team&#39;: 2.75, &#39;odds_away_team&#39;: 2.7, &#39;odds_draw&#39;: 3.3529411764705883, &#39;preview_date&#39;: datetime.date(2022, 1, 21), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/21/everton-aston-villa-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Wolves&#39;, &#39;away_team&#39;: &#39;Southampton&#39;, &#39;text&#39;: &#39;Southampton were excellent in their 4-1 stroll past Brentford and will arrive confident they can continue their rise up the table with another win at Molineux. However, Wolves are also enjoying a nice run of form and will hope Roman Saïss’s departure to the Africa Cup of Nations does not harm their ironclad defence. Only 14 goals conceded after 19 games is remarkable and Manchester City are the sole side who have a better record, with 13. Ralph Hasenhüttl will be meticulously planning how to break his opponents down and he can focus his side on this task as Wolves’ achilles heel is a lack of creativity. They have also scored only 14 goals and again only one side beat their tally, Norwich with eight. Graham Searles&#39;, &#39;author&#39;: &#39;Graham Searles&#39;, &#39;venue&#39;: &#39;Molineux&#39;, &#39;referee&#39;: &#39;Michael Salisbury&#39;, &#39;odds&#39;: [&#39;11-8&#39;, &#39;5-2&#39;, &#39;9-4&#39;], &#39;odds_home_team&#39;: 2.375, &#39;odds_away_team&#39;: 3.5, &#39;odds_draw&#39;: 3.25, &#39;preview_date&#39;: datetime.date(2022, 1, 14), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/14/wolves-southampton-match-preview-premeir-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Liverpool&#39;, &#39;away_team&#39;: &#39;Brentford&#39;, &#39;text&#39;: &#39;Albert Stubbins, the only footballer to feature on the cover of the Beatles’ Sgt. Pepper’s album, scored the winner when Liverpool last hosted Brentford at Anfield in the league. That was in October 1946. Seventy-six years on, Jürgen Klopp takes charge of Liverpool for the 350th time boasting the highest win percentage (60.74%) of any manager in the club’s league history. With Manchester City or Chelsea, or both, guaranteed to drop points when they meet on Saturday, Klopp will be desperately seeking an improvement on Thursday’s display against Arsenal to take advantage. Andy Hunter&#39;, &#39;author&#39;: &#39;Andy Hunter&#39;, &#39;venue&#39;: &#39;Anfield&#39;, &#39;referee&#39;: &#39;Jon Moss&#39;, &#39;odds&#39;: [&#39;1-3&#39;, &#39;21-2&#39;, &#39;5-1&#39;], &#39;odds_home_team&#39;: 1.3333333333333333, &#39;odds_away_team&#39;: 11.5, &#39;odds_draw&#39;: 6.0, &#39;preview_date&#39;: datetime.date(2022, 1, 15), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/15/liverpool-brentford-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;West Ham&#39;, &#39;away_team&#39;: &#39;Leeds&#39;, &#39;text&#39;: &#39;West Ham regained fourth place by beating Norwich on Wednesday and will hope to continue their winning run when they host Leeds. They saw them off in the FA Cup last week and Marcelo Bielsa’s side, who are eight points above the bottom three, still have a long injury list. Bielsa will hope Patrick Bamford and Rodrigo are back to lift his side’s attacking threat. West Ham, meanwhile, are sweating on Mark Noble and Tomas Soucek, with Kurt Zouma also pushing for a place on the bench. Jacob Steinberg&#39;, &#39;author&#39;: &#39;Jacob Steinberg&#39;, &#39;venue&#39;: &#39;London Stadium&#39;, &#39;referee&#39;: &#39;Mike Dean&#39;, &#39;odds&#39;: [&#39;4-6&#39;, &#39;43-10&#39;, &#39;3-1&#39;], &#39;odds_home_team&#39;: 1.6666666666666665, &#39;odds_away_team&#39;: 5.3, &#39;odds_draw&#39;: 4.0, &#39;preview_date&#39;: datetime.date(2022, 1, 15), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/15/west-ham-leeds-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Aston Villa&#39;, &#39;away_team&#39;: &#39;Manchester United&#39;, &#39;text&#39;: &#39;The extent of the problems Ralf Rangnick has inherited at Manchester United need to be put in perspective. The fortunate 1-0 win over Aston Villa in the FA Cup on Monday was the latest example of how disjointed the team are but also meant United have lost once in 10 games under their interim manager. Scoring goals remains a problem but the return of Cristiano Ronaldo and Jadon Sancho from injury should give them more of a cutting edge. Villa will be keen to avenge their Cup defeat and Steven Gerrard is expected to give Philippe Coutinho and Lucas Digne debuts. Stephen Hollis&#39;, &#39;author&#39;: &#39;Stephen Hollis&#39;, &#39;venue&#39;: &#39;Villa Park&#39;, &#39;referee&#39;: &#39;David Coote&#39;, &#39;odds&#39;: [&#39;2-1&#39;, &#39;19-13&#39;, &#39;13-5&#39;], &#39;odds_home_team&#39;: 3.0, &#39;odds_away_team&#39;: 2.4615384615384617, &#39;odds_draw&#39;: 3.6, &#39;preview_date&#39;: datetime.date(2022, 1, 14), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/14/aston-villa-manchester-united-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Leicester&#39;, &#39;away_team&#39;: &#39;Brighton&#39;, &#39;text&#39;: &#39;Brendan Rodgers blamed naivety for the extraordinary way Leicester allowed victory to turn into defeat against Tottenham on Wednesday, but his team are becoming old hands at shooting themselves in the foot. There is mitigation: they have been hampered by injuries all season and are still without a raft of key players. But they still need to wise up quickly if they are to retain hope of reaching Europe. Brighton have similar ambitions and are in much better form – all they need to do is sharpen their finishing and they could add to Leicester’s woes. Paul Doyle&#39;, &#39;author&#39;: &#39;Paul Doyle&#39;, &#39;venue&#39;: &#39;King Power Stadium&#39;, &#39;referee&#39;: &#39;Martin Atkinson&#39;, &#39;odds&#39;: [&#39;8-5&#39;, &#39;9-2&#39;, &#39;12-5&#39;], &#39;odds_home_team&#39;: 2.6, &#39;odds_away_team&#39;: 5.5, &#39;odds_draw&#39;: 3.4, &#39;preview_date&#39;: datetime.date(2022, 1, 22), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/22/leicester-brighton-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Leeds&#39;, &#39;away_team&#39;: &#39;Burnley&#39;, &#39;text&#39;: &#39;The bad news for Marcelo Bielsa and Leeds is that Kalvin Phillips, their England midfielder and anchor, and Liam Cooper, their captain and usually ever-present centre-half, will be absent injured until March. Patrick Bamford is set to return to the home attack, though, after hamstring trouble and, although Bielsa’s principal striker is expected to begin on the bench, he will doubtless be anxious to enter the fray and jog Sean Dyche’s memory. Bamford did not exactly see eye to eye with Burnley’s manager during a loan stint at Turf Moor and would surely revel in proving a point by scoring the winning goal. Louise Taylor&#39;, &#39;author&#39;: &#39;Louise Taylor&#39;, &#39;venue&#39;: &#39;Elland Road&#39;, &#39;referee&#39;: &#39;Kevin Friend&#39;, &#39;odds&#39;: [&#39;6-5&#39;, &#39;5-2&#39;, &#39;13-5&#39;], &#39;odds_home_team&#39;: 2.2, &#39;odds_away_team&#39;: 3.5, &#39;odds_draw&#39;: 3.6, &#39;preview_date&#39;: datetime.date(2022, 1, 1), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/01/leeds-burnley-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Leeds&#39;, &#39;away_team&#39;: &#39;Newcastle&#39;, &#39;text&#39;: &#39;Can Eddie Howe choreograph Newcastle’s second win of the season before their flight to Saudi Arabia for a warm-weather training camp on the Red Sea coast near Jeddah on Sunday? It will not be easy, particularly as Marcelo Bielsa knows victory would go a long way towards helping banish Leeds’ own, albeit latterly receding, relegation fears. A key subplot could involve a duel between Raphinha and Newcastle’s underrated left-back Paul Dummett, who impressed against Watford last Saturday on his return from a long-term injury. Louise Taylor&#39;, &#39;author&#39;: &#39;Louise Taylor&#39;, &#39;venue&#39;: &#39;Elland Road&#39;, &#39;referee&#39;: &#39;Chris Kavanagh&#39;, &#39;odds&#39;: [&#39;1-1&#39;, &#39;3-1&#39;, &#39;5-2&#39;], &#39;odds_home_team&#39;: 2.0, &#39;odds_away_team&#39;: 4.0, &#39;odds_draw&#39;: 3.5, &#39;preview_date&#39;: datetime.date(2022, 1, 21), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/21/leeds-newcastle-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Brentford&#39;, &#39;away_team&#39;: &#39;Aston Villa&#39;, &#39;text&#39;: &#39;Steven Gerrard returns to the touchline for Aston Villa after recovering from Covid but will be without the suspended Tyrone Mings as well as the injured Leon Bailey and Marvelous Nakamba. Ezri Konsa and Ollie Watkins are set to start against their former club. Depleted Brentford, looking to avoid a fourth consecutive defeat, can expect to have more possession than the 23% they managed in their midweek loss to Manchester City. Tim Knowles&#39;, &#39;author&#39;: &#39;Tim Knowles&#39;, &#39;venue&#39;: &#39;Brentford Community Stadium&#39;, &#39;referee&#39;: &#39;Craig Pawson&#39;, &#39;odds&#39;: [&#39;2-1&#39;, &#39;6-4&#39;, &#39;2-1&#39;], &#39;odds_home_team&#39;: 3.0, &#39;odds_away_team&#39;: 2.5, &#39;odds_draw&#39;: 3.0, &#39;preview_date&#39;: datetime.date(2022, 1, 1), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/01/brentford-aston-villa-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Norwich&#39;, &#39;away_team&#39;: &#39;Everton&#39;, &#39;text&#39;: &#39;If Norwich have any hope of staging an unlikely bid for survival it surely has to start with the visit of an Everton side in almost similarly dire straits. After taking five points from his first three matches, Dean Smith has presided over six consecutive Premier League defeats – failing to score a single goal. Everton have won once in their past 11 league games but Rafael Benítez will hope the signings of Nathan Patterson, Vitalii Mykolenko and Anwar El Ghazi will revitalise them along with the hoped-for returns to fitness of Dominic Calvert-Lewin, Yerry Mina and Richarlison. Stephen Hollis&#39;, &#39;author&#39;: &#39;Stephen Hollis&#39;, &#39;venue&#39;: &#39;Carrow Road&#39;, &#39;referee&#39;: &#39;Andy Madley&#39;, &#39;odds&#39;: [&#39;37-13&#39;, &#39;19-17&#39;, &#39;18-7&#39;], &#39;odds_home_team&#39;: 3.8461538461538463, &#39;odds_away_team&#39;: 2.1176470588235294, &#39;odds_draw&#39;: 3.5714285714285716, &#39;preview_date&#39;: datetime.date(2022, 1, 14), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/14/norwich-everton-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Southampton&#39;, &#39;away_team&#39;: &#39;Manchester City&#39;, &#39;text&#39;: &#39;Manchester City have won 12 league matches in succession and, in such irresistible form, look very likely to make it 13 at Southampton. A swathe of pundits believe City need to sign a striker before the window closes and possibly this would help Pep Guardiola finally get over the line in the Champions League, but domestically they are cruising to glory without the frivolities of an out-and-out No 9. In the process they are making the rest of the top flight rather red-faced as no one seems able to stop City’s Rube Goldberg goal machine. Ralph Hasenhüttl’s side will need to be supremely focussed from the off and that’s just to avoid a thrashing. Graham Searles&#39;, &#39;author&#39;: &#39;Graham Searles&#39;, &#39;venue&#39;: &#39;St Mary’s Stadium&#39;, &#39;referee&#39;: &#39;Simon Hooper&#39;, &#39;odds&#39;: [&#39;23-2&#39;, &#39;3-10&#39;, &#39;11-2&#39;], &#39;odds_home_team&#39;: 12.5, &#39;odds_away_team&#39;: 1.3, &#39;odds_draw&#39;: 6.5, &#39;preview_date&#39;: datetime.date(2022, 1, 21), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/21/southampton-manchester-city-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Tottenham&#39;, &#39;away_team&#39;: &#39;Arsenal&#39;, &#39;text&#39;: &#39;For the first time in a while more than just bragging rights are up for grabs in the north London derby. Arsenal head to the Tottenham Hotspur Stadium in fifth place and with genuine hope of forcing their way into the Champions League for the first time since the 2016-17 season. Tottenham sit two points behind them thanks to a run of eight league games undefeated since Antonio Conte’s appointment. Tottenham will be without Son Heung-min and Eric Dier while Granit Xhaka is suspended for Arsenal following his second red card of the season. Stephen Hollis&#39;, &#39;author&#39;: &#39; Stephen Hollis&#39;, &#39;venue&#39;: &#39;Tottenham Hotspur Stadium&#39;, &#39;referee&#39;: &#39;Chris Kavanagh&#39;, &#39;odds&#39;: [&#39;8-5&#39;, &#39;2-1&#39;, &#39;12-5&#39;], &#39;odds_home_team&#39;: 2.6, &#39;odds_away_team&#39;: 3.0, &#39;odds_draw&#39;: 3.4, &#39;preview_date&#39;: datetime.date(2022, 1, 15), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/15/tottenham-arsenal-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Chelsea&#39;, &#39;away_team&#39;: &#39;Tottenham&#39;, &#39;text&#39;: &#39;The dynamic has changed before Chelsea and Tottenham meet for the third time this month. Chelsea dominated their rivals in the Carabao Cup semi-finals but Thomas Tuchel’s side have stuttered in the league and Spurs are on a high after their dramatic win at Leicester. Harry Kane is scoring again and Antonio Conte, who remains unbeaten in the league since his arrival in north London, will sense a chance to drag his old team into a battle for a place in the top four. Jacob Steinberg&#39;, &#39;author&#39;: &#39;Jacob Steinberg&#39;, &#39;venue&#39;: &#39;Stamford Bridge&#39;, &#39;referee&#39;: &#39;Paul Tierney&#39;, &#39;odds&#39;: [&#39;13-18&#39;, &#39;9-2&#39;, &#39;13-4&#39;], &#39;odds_home_team&#39;: 1.7222222222222223, &#39;odds_away_team&#39;: 5.5, &#39;odds_draw&#39;: 4.25, &#39;preview_date&#39;: datetime.date(2022, 1, 22), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/22/chelsea-tottenham-match-preview-premier-league&#39;}
-----------------------------------------------
{&#39;home_team&#39;: &#39;Chelsea&#39;, &#39;away_team&#39;: &#39;Liverpool&#39;, &#39;text&#39;: &#39;After threatening a three-way title race, Chelsea and Liverpool both find themselves on the brink of dropping out of contention. Manchester City have opened up an imposing lead at the top of the table and can look on comfortably when their rivals meet at Stamford Bridge on Sunday afternoon. The champions will take some stopping from here. They have seen Liverpool pick up one point from their last two games and the signs are ominous for Chelsea. Thomas Tuchel has mounting injury problems at the back and is dealing with the fallout from Romelu Lukaku’s explosive interview. Jacob Steinberg&#39;, &#39;author&#39;: &#39;Jacob Steinberg&#39;, &#39;venue&#39;: &#39;Stamford Bridge&#39;, &#39;referee&#39;: &#39;Anthony Taylor&#39;, &#39;odds&#39;: [&#39;2-1&#39;, &#39;7-5&#39;, &#39;13-5&#39;], &#39;odds_home_team&#39;: 3.0, &#39;odds_away_team&#39;: 2.4, &#39;odds_draw&#39;: 3.6, &#39;preview_date&#39;: datetime.date(2022, 1, 1), &#39;preview_link&#39;: &#39;https://www.theguardian.com/football/2022/jan/01/chelsea-liverpool-match-preview-premier-league&#39;}
-----------------------------------------------
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_previews_information</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>home_team</th>
      <th>away_team</th>
      <th>text</th>
      <th>author</th>
      <th>venue</th>
      <th>referee</th>
      <th>odds</th>
      <th>odds_home_team</th>
      <th>odds_away_team</th>
      <th>odds_draw</th>
      <th>preview_date</th>
      <th>preview_link</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Crystal Palace</td>
      <td>Liverpool</td>
      <td>Liverpool have already dispelled most of the d...</td>
      <td>Stephen Hollis</td>
      <td>Selhurst Park</td>
      <td>Kevin Friend</td>
      <td>[5-1, 8-13, 10-3]</td>
      <td>6.000000</td>
      <td>1.615385</td>
      <td>4.333333</td>
      <td>2022-01-22</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Newcastle</td>
      <td>Watford</td>
      <td>Moussa Sissoko returns to Newcastle in Watford...</td>
      <td>Louise Taylor</td>
      <td>St James’ Park</td>
      <td>Paul Tierney</td>
      <td>[19-17, 27-10, 27-10]</td>
      <td>2.117647</td>
      <td>3.700000</td>
      <td>3.700000</td>
      <td>2022-01-14</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Manchester United</td>
      <td>West Ham</td>
      <td>This is a genuine six-pointer in which Manches...</td>
      <td>Jamie Jackson</td>
      <td>Old Trafford</td>
      <td>Jon Moss</td>
      <td>[10-11, 3-1, 11-4]</td>
      <td>1.909091</td>
      <td>4.000000</td>
      <td>3.750000</td>
      <td>2022-01-21</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manchester City</td>
      <td>Chelsea</td>
      <td>Manchester City would surely finish off Chelse...</td>
      <td>Jamie Jackson</td>
      <td>Etihad Stadium</td>
      <td>Craig Pawson</td>
      <td>[8-11, 22-5, 3-1]</td>
      <td>1.727273</td>
      <td>5.400000</td>
      <td>4.000000</td>
      <td>2022-01-14</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arsenal</td>
      <td>Burnley</td>
      <td>Arsenal have no excuses if their dismal form i...</td>
      <td>Graham Searles</td>
      <td>Emirates Stadium</td>
      <td>David Coote</td>
      <td>[2-5, 9-1, 4-1]</td>
      <td>1.400000</td>
      <td>10.000000</td>
      <td>5.000000</td>
      <td>2022-01-22</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Brentford</td>
      <td>Wolves</td>
      <td>Wolves have arguably been the surprise package...</td>
      <td>Stephen Hollis</td>
      <td>Brentford Community Stadium</td>
      <td>Peter Bankes</td>
      <td>[9-4, 13-8, 2-1]</td>
      <td>3.250000</td>
      <td>2.625000</td>
      <td>3.000000</td>
      <td>2022-01-21</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Everton</td>
      <td>Aston Villa</td>
      <td>The second caretaker coming of Duncan Ferguson...</td>
      <td>Andy Hunter</td>
      <td>Goodison Park</td>
      <td>Craig Pawson</td>
      <td>[7-4, 17-10, 40-17]</td>
      <td>2.750000</td>
      <td>2.700000</td>
      <td>3.352941</td>
      <td>2022-01-21</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Wolves</td>
      <td>Southampton</td>
      <td>Southampton were excellent in their 4-1 stroll...</td>
      <td>Graham Searles</td>
      <td>Molineux</td>
      <td>Michael Salisbury</td>
      <td>[11-8, 5-2, 9-4]</td>
      <td>2.375000</td>
      <td>3.500000</td>
      <td>3.250000</td>
      <td>2022-01-14</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Liverpool</td>
      <td>Brentford</td>
      <td>Albert Stubbins, the only footballer to featur...</td>
      <td>Andy Hunter</td>
      <td>Anfield</td>
      <td>Jon Moss</td>
      <td>[1-3, 21-2, 5-1]</td>
      <td>1.333333</td>
      <td>11.500000</td>
      <td>6.000000</td>
      <td>2022-01-15</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>West Ham</td>
      <td>Leeds</td>
      <td>West Ham regained fourth place by beating Norw...</td>
      <td>Jacob Steinberg</td>
      <td>London Stadium</td>
      <td>Mike Dean</td>
      <td>[4-6, 43-10, 3-1]</td>
      <td>1.666667</td>
      <td>5.300000</td>
      <td>4.000000</td>
      <td>2022-01-15</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Aston Villa</td>
      <td>Manchester United</td>
      <td>The extent of the problems Ralf Rangnick has i...</td>
      <td>Stephen Hollis</td>
      <td>Villa Park</td>
      <td>David Coote</td>
      <td>[2-1, 19-13, 13-5]</td>
      <td>3.000000</td>
      <td>2.461538</td>
      <td>3.600000</td>
      <td>2022-01-14</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Leicester</td>
      <td>Brighton</td>
      <td>Brendan Rodgers blamed naivety for the extraor...</td>
      <td>Paul Doyle</td>
      <td>King Power Stadium</td>
      <td>Martin Atkinson</td>
      <td>[8-5, 9-2, 12-5]</td>
      <td>2.600000</td>
      <td>5.500000</td>
      <td>3.400000</td>
      <td>2022-01-22</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Leeds</td>
      <td>Burnley</td>
      <td>The bad news for Marcelo Bielsa and Leeds is t...</td>
      <td>Louise Taylor</td>
      <td>Elland Road</td>
      <td>Kevin Friend</td>
      <td>[6-5, 5-2, 13-5]</td>
      <td>2.200000</td>
      <td>3.500000</td>
      <td>3.600000</td>
      <td>2022-01-01</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Leeds</td>
      <td>Newcastle</td>
      <td>Can Eddie Howe choreograph Newcastle’s second ...</td>
      <td>Louise Taylor</td>
      <td>Elland Road</td>
      <td>Chris Kavanagh</td>
      <td>[1-1, 3-1, 5-2]</td>
      <td>2.000000</td>
      <td>4.000000</td>
      <td>3.500000</td>
      <td>2022-01-21</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Brentford</td>
      <td>Aston Villa</td>
      <td>Steven Gerrard returns to the touchline for As...</td>
      <td>Tim Knowles</td>
      <td>Brentford Community Stadium</td>
      <td>Craig Pawson</td>
      <td>[2-1, 6-4, 2-1]</td>
      <td>3.000000</td>
      <td>2.500000</td>
      <td>3.000000</td>
      <td>2022-01-01</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Norwich</td>
      <td>Everton</td>
      <td>If Norwich have any hope of staging an unlikel...</td>
      <td>Stephen Hollis</td>
      <td>Carrow Road</td>
      <td>Andy Madley</td>
      <td>[37-13, 19-17, 18-7]</td>
      <td>3.846154</td>
      <td>2.117647</td>
      <td>3.571429</td>
      <td>2022-01-14</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Southampton</td>
      <td>Manchester City</td>
      <td>Manchester City have won 12 league matches in ...</td>
      <td>Graham Searles</td>
      <td>St Mary’s Stadium</td>
      <td>Simon Hooper</td>
      <td>[23-2, 3-10, 11-2]</td>
      <td>12.500000</td>
      <td>1.300000</td>
      <td>6.500000</td>
      <td>2022-01-21</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Tottenham</td>
      <td>Arsenal</td>
      <td>For the first time in a while more than just b...</td>
      <td>Stephen Hollis</td>
      <td>Tottenham Hotspur Stadium</td>
      <td>Chris Kavanagh</td>
      <td>[8-5, 2-1, 12-5]</td>
      <td>2.600000</td>
      <td>3.000000</td>
      <td>3.400000</td>
      <td>2022-01-15</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Chelsea</td>
      <td>Tottenham</td>
      <td>The dynamic has changed before Chelsea and Tot...</td>
      <td>Jacob Steinberg</td>
      <td>Stamford Bridge</td>
      <td>Paul Tierney</td>
      <td>[13-18, 9-2, 13-4]</td>
      <td>1.722222</td>
      <td>5.500000</td>
      <td>4.250000</td>
      <td>2022-01-22</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Chelsea</td>
      <td>Liverpool</td>
      <td>After threatening a three-way title race, Chel...</td>
      <td>Jacob Steinberg</td>
      <td>Stamford Bridge</td>
      <td>Anthony Taylor</td>
      <td>[2-1, 7-5, 13-5]</td>
      <td>3.000000</td>
      <td>2.400000</td>
      <td>3.600000</td>
      <td>2022-01-01</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">home_team</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;Crystal Palace&#39;, &#39;Newcastle&#39;, &#39;Manchester United&#39;,
       &#39;Manchester City&#39;, &#39;Arsenal&#39;, &#39;Brentford&#39;, &#39;Everton&#39;, &#39;Wolves&#39;,
       &#39;Liverpool&#39;, &#39;West Ham&#39;, &#39;Aston Villa&#39;, &#39;Leicester&#39;, &#39;Leeds&#39;,
       &#39;Norwich&#39;, &#39;Southampton&#39;, &#39;Tottenham&#39;, &#39;Chelsea&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">away_team</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;Liverpool&#39;, &#39;Watford&#39;, &#39;West Ham&#39;, &#39;Chelsea&#39;, &#39;Burnley&#39;, &#39;Wolves&#39;,
       &#39;Aston Villa&#39;, &#39;Southampton&#39;, &#39;Brentford&#39;, &#39;Leeds&#39;,
       &#39;Manchester United&#39;, &#39;Brighton&#39;, &#39;Newcastle&#39;, &#39;Everton&#39;,
       &#39;Manchester City&#39;, &#39;Arsenal&#39;, &#39;Tottenham&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;.//datasets//previews.csv&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-2-:-Mapping">Part 2 : Mapping<a class="anchor-link" href="#Part-2-:-Mapping"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;.//datasets//final_data.csv&quot;</span><span class="p">)</span>
<span class="c1"># extracted previews</span>
<span class="n">df_guardian</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;.//datasets//previews.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_dict</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>optaId</th>
      <th>name</th>
      <th>symid</th>
      <th>shortClubName</th>
      <th>optaName</th>
      <th>whoScoredName</th>
      <th>sofifaName</th>
      <th>statsName</th>
      <th>inStatName</th>
      <th>transfermarktName</th>
      <th>fotmobName</th>
      <th>oddsportalName</th>
      <th>fminsideName</th>
      <th>nickName1</th>
      <th>nickName2</th>
      <th>nickName3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9e78bbc137fd00c66162080bc9e987e67297643dc50616...</td>
      <td>3</td>
      <td>Arsenal</td>
      <td>ARS</td>
      <td>Arsenal</td>
      <td>Arsenal</td>
      <td>Arsenal</td>
      <td>Arsenal</td>
      <td>Arsenal</td>
      <td>Arsenal FC</td>
      <td>Arsenal FC</td>
      <td>Arsenal</td>
      <td>Arsenal</td>
      <td>Arsenal</td>
      <td>Arsenal FC</td>
      <td>Arsenal Football Club</td>
      <td>The Gunners</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0ef9883721814dd09038659130c61c76f18976cb7b8e86...</td>
      <td>47</td>
      <td>Portsmouth</td>
      <td>POR</td>
      <td>Portsmouth</td>
      <td>Portsmouth</td>
      <td>Portsmouth</td>
      <td>Portsmouth</td>
      <td>Portsmouth</td>
      <td>Portsmouth</td>
      <td>Portsmouth FC</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Portsmouth FC</td>
      <td>Portsmouth Football Club</td>
      <td>Pompey</td>
    </tr>
    <tr>
      <th>2</th>
      <td>eb89c068ca204a72408360450847a990c97c5b5ff0ec9f...</td>
      <td>110</td>
      <td>Stoke City</td>
      <td>STK</td>
      <td>Stoke</td>
      <td>Stoke City</td>
      <td>Stoke</td>
      <td>Stoke City</td>
      <td>Stoke City</td>
      <td>Stoke</td>
      <td>Stoke City</td>
      <td>Stoke</td>
      <td>Stoke</td>
      <td>Stoke</td>
      <td>Stoke City FC</td>
      <td>Stoke City Football Club</td>
      <td>The Potters</td>
    </tr>
    <tr>
      <th>3</th>
      <td>c1a486f8ca465e58b6301f038e754058986187d454110c...</td>
      <td>56</td>
      <td>Sunderland</td>
      <td>SUN</td>
      <td>Sunderland</td>
      <td>Sunderland</td>
      <td>Sunderland</td>
      <td>Sunderland</td>
      <td>Sunderland</td>
      <td>Sunderland AFC</td>
      <td>Sunderland AFC</td>
      <td>Sunderland</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Sunderland FC</td>
      <td>Sunderland Association Football Club</td>
      <td>Sunderland A.F.C.</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0db353094ccf93e0005cf378ea862b56e77cacc57b7c5e...</td>
      <td>111</td>
      <td>Wigan Athletic</td>
      <td>WIG</td>
      <td>Wigan</td>
      <td>Wigan Athletic</td>
      <td>Wigan</td>
      <td>Wigan Athletic</td>
      <td>Wigan Athletic</td>
      <td>Wigan Athletic</td>
      <td>Wigan Athletic</td>
      <td>Wigan</td>
      <td>Wigan</td>
      <td>NaN</td>
      <td>Wigan Athletic FC</td>
      <td>Wigan Athletic Football Club</td>
      <td>The Latics The Tics</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_guardian</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>home_team</th>
      <th>away_team</th>
      <th>text</th>
      <th>author</th>
      <th>venue</th>
      <th>referee</th>
      <th>odds</th>
      <th>odds_home_team</th>
      <th>odds_away_team</th>
      <th>odds_draw</th>
      <th>preview_date</th>
      <th>preview_link</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Crystal Palace</td>
      <td>Liverpool</td>
      <td>Liverpool have already dispelled most of the d...</td>
      <td>Stephen Hollis</td>
      <td>Selhurst Park</td>
      <td>Kevin Friend</td>
      <td>['5-1', '8-13', '10-3']</td>
      <td>6.000000</td>
      <td>1.615385</td>
      <td>4.333333</td>
      <td>2022-01-22</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Newcastle</td>
      <td>Watford</td>
      <td>Moussa Sissoko returns to Newcastle in Watford...</td>
      <td>Louise Taylor</td>
      <td>St James’ Park</td>
      <td>Paul Tierney</td>
      <td>['19-17', '27-10', '27-10']</td>
      <td>2.117647</td>
      <td>3.700000</td>
      <td>3.700000</td>
      <td>2022-01-14</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Manchester United</td>
      <td>West Ham</td>
      <td>This is a genuine six-pointer in which Manches...</td>
      <td>Jamie Jackson</td>
      <td>Old Trafford</td>
      <td>Jon Moss</td>
      <td>['10-11', '3-1', '11-4']</td>
      <td>1.909091</td>
      <td>4.000000</td>
      <td>3.750000</td>
      <td>2022-01-21</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manchester City</td>
      <td>Chelsea</td>
      <td>Manchester City would surely finish off Chelse...</td>
      <td>Jamie Jackson</td>
      <td>Etihad Stadium</td>
      <td>Craig Pawson</td>
      <td>['8-11', '22-5', '3-1']</td>
      <td>1.727273</td>
      <td>5.400000</td>
      <td>4.000000</td>
      <td>2022-01-14</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arsenal</td>
      <td>Burnley</td>
      <td>Arsenal have no excuses if their dismal form i...</td>
      <td>Graham Searles</td>
      <td>Emirates Stadium</td>
      <td>David Coote</td>
      <td>['2-5', '9-1', '4-1']</td>
      <td>1.400000</td>
      <td>10.000000</td>
      <td>5.000000</td>
      <td>2022-01-22</td>
      <td>https://www.theguardian.com/football/2022/jan/...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df_guardian</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">PreviewsMapping</span><span class="o">.</span><span class="n">save_mapped_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">df_dict</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/meherkh/anaconda3/envs/Real_Analytics/lib/python3.7/site-packages/dateparser/date_parser.py:35: PytzUsageWarning: The localize method is no longer necessary, as this time zone supports the fold attribute (PEP 495). For more details on migrating to a PEP 495-compliant implementation, see https://pytz-deprecation-shim.readthedocs.io/en/latest/migration.html
  date_obj = stz.localize(date_obj)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

